<!-- ===========================
✅ public/index.html (รวมครบ)
- หน้า Home → กดเข้า /members/
- หน้า Members → ดึงข้อมูลจาก /members.json
- มี /admin/ แก้รายชื่อได้ (Decap CMS)
- มี Music Player ย่อ/ขยายได้
=========================== -->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MEENPRO</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;800&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --txt:rgba(255,255,255,.92);
  --muted:rgba(255,255,255,.55);
  --shadow:0 18px 45px rgba(0,0,0,.55);
}
html,body{height:100%}
body{
  font-family:'Montserrat',sans-serif;
  color:#fff;
  overflow-x:hidden;
  background:url('https://img2.pic.in.th/kkd6b95b26498f7bf7.png') center/cover no-repeat;
  position:relative;
}
body::before{
  content:"";
  position:fixed; inset:0;
  background:rgba(0,0,0,.75);
  backdrop-filter:blur(8px);
  pointer-events:none;
}

/* ===== SPA pages ===== */
.page{
  min-height:100vh;
  position:relative; z-index:2;
  opacity:0; transform:translateY(10px);
  transition:opacity .28s ease, transform .28s ease;
  display:none;
}
.page.active{display:block}
.page.show{opacity:1; transform:translateY(0)}

/* ===== HOME ===== */
.home-wrap{
  min-height:100vh;
  padding:40px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  text-align:center;
}
.title{font-weight:800;font-size:64px;letter-spacing:14px}
.subtitle{margin-top:12px;font-size:12px;letter-spacing:6px;opacity:.6}

.center-glass{
  margin-top:60px;
  width:min(950px, 90vw);
  height:320px;
  border-radius:28px;
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.15);
  backdrop-filter:blur(20px);
  position:relative;
  overflow:hidden;
  display:flex;
  justify-content:center;
  align-items:center;
  cursor:pointer;
  transition:transform .18s ease, background .18s ease, border-color .18s ease;
}
.center-glass:hover{
  transform:translateY(-2px);
  background:rgba(255,255,255,0.10);
  border-color:rgba(255,255,255,0.22);
}
.center-glass:active{transform:translateY(0) scale(.995)}
.center-img{
  position:absolute; top:50%; left:50%;
  transform:translate(-50%,-50%);
  max-width:100%; max-height:100%;
  filter:brightness(.92);
  pointer-events:none;
}
.center-overlay{
  position:absolute; inset:0;
  background:linear-gradient(
    to right,
    rgba(0,0,0,0.85),
    rgba(0,0,0,0.25) 25%,
    rgba(0,0,0,0.25) 75%,
    rgba(0,0,0,0.85)
  );
  pointer-events:none;
}
.center-content{position:relative;z-index:2}
.center-content h2{font-size:42px;font-weight:800}
.center-content p{margin-top:10px;font-size:16px;opacity:.75}

/* ===== MEMBERS ===== */
.members-wrap{
  max-width:1100px;
  margin:0 auto;
  padding:42px 22px 120px;
}
.top{text-align:center;margin-bottom:24px}
.top h1{font-size:46px;letter-spacing:3px;font-weight:800}
.top .sub{
  margin-top:10px;
  display:inline-flex;
  gap:14px;
  align-items:center;
  color:var(--muted);
  font-size:11px;
  letter-spacing:3px;
}
.top .sub::before,.top .sub::after{
  content:""; width:64px;height:1px;
  background:rgba(255,255,255,.12);
  display:inline-block;
}
.toolbar{
  margin:18px auto 0;
  display:flex; gap:12px;
  align-items:center;
  justify-content:center;
  flex-wrap:wrap;
}
.back-btn{
  border:none; cursor:pointer;
  border-radius:999px;
  padding:10px 14px;
  background:rgba(255,255,255,0.10);
  border:1px solid rgba(255,255,255,0.14);
  color:#fff;
  font-size:12px;
  letter-spacing:1px;
}
.back-btn:hover{background:rgba(255,255,255,0.14)}
.searchbar{
  width:min(340px, 92vw);
  display:flex; align-items:center; gap:10px;
  padding:10px 12px;
  border:1px solid rgba(255,255,255,.12);
  border-radius:12px;
  background:rgba(0,0,0,.22);
  backdrop-filter:blur(10px);
}
.searchbar svg{width:16px;height:16px;opacity:.65}
.searchbar input{
  width:100%;
  background:transparent;
  border:none;
  outline:none;
  color:var(--txt);
  font-size:12px;
}
.searchbar input::placeholder{color:rgba(255,255,255,.35)}

.section{margin-top:22px}
.section-head{display:flex;align-items:baseline;gap:12px;margin:18px 0 12px}
.section-head h2{font-size:18px;font-weight:800;letter-spacing:1px}
.section-head .idx{color:rgba(255,255,255,.35);font-size:12px;letter-spacing:2px}

.grid{
  display:grid;
  grid-template-columns:repeat(3, minmax(0,1fr));
  gap:14px;
}
@media (max-width:980px){.grid{grid-template-columns:repeat(2, minmax(0,1fr));}}
@media (max-width:560px){
  .grid{grid-template-columns:1fr;}
  .title{font-size:44px;letter-spacing:10px}
}

.card{
  border-radius:14px;
  background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.10);
  padding:12px;
  display:flex;
  gap:12px;
  align-items:center;
  min-height:74px;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
  position:relative;
  overflow:hidden;
}
.card::after{
  content:"";
  position:absolute; inset:-40px;
  background:radial-gradient(circle at 20% 10%, rgba(255,255,255,.08), transparent 55%);
  opacity:.45;
  pointer-events:none;
}
.avatar{
  width:46px;height:46px;
  border-radius:12px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,.12);
  background:rgba(0,0,0,.25);
  flex:0 0 auto;
}
.avatar img{width:100%;height:100%;object-fit:cover}
.info{flex:1;min-width:0}
.badge{
  display:inline-flex;
  align-items:center;
  gap:6px;
  font-size:10px;
  letter-spacing:2px;
  opacity:.9;
  margin-bottom:6px;
}
.badge .tag{
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.10);
  background:rgba(0,0,0,.18);
}
.name{
  font-weight:800;
  font-size:13px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}
.meta{
  display:flex;
  gap:10px;
  align-items:center;
  margin-top:6px;
  font-size:11px;
}
.dot{width:8px;height:8px;border-radius:999px;background:#37d46b;box-shadow:0 0 14px rgba(55,212,107,.25)}
.link{color:#4aa7ff;text-decoration:none;opacity:.95}
.link:hover{text-decoration:underline}

.card.founder{border-color:rgba(202,162,75,.45)}
.card.founder .badge .tag{border-color:rgba(202,162,75,.45); color:rgba(255,220,150,.95)}
.card.leader{border-color:rgba(184,59,59,.45)}
.card.leader .badge .tag{border-color:rgba(184,59,59,.45); color:rgba(255,170,170,.95)}
.card.member{border-color:rgba(255,255,255,.10)}
.card.member .badge .tag{border-color:rgba(255,255,255,.10); color:rgba(255,255,255,.70)}

/* ===== Player ===== */
.player{
  position:fixed; right:18px; bottom:16px; z-index:999;
  width:340px;
  border-radius:20px;
  background:rgba(0,0,0,0.78);
  border:1px solid rgba(255,255,255,0.12);
  backdrop-filter:blur(14px);
  padding:14px;
  box-shadow:var(--shadow);
  transition:.22s ease;
}
.player.collapsed{width:200px;padding:12px}
.player.collapsed .player-body{display:none}
.player.collapsed .player-head{margin-bottom:0}
.player-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}
.nowplaying{font-size:10px;letter-spacing:2.5px;opacity:.65}
.toggle{
  width:30px;height:30px;border-radius:999px;
  border:1px solid rgba(255,255,255,0.14);
  background:rgba(255,255,255,0.06);
  color:#fff;cursor:pointer;display:grid;place-items:center;user-select:none;
}
.toggle:hover{background:rgba(255,255,255,0.10)}
.player-row{display:flex;gap:12px;align-items:center}
.cover{width:52px;height:52px;border-radius:14px;overflow:hidden;border:1px solid rgba(255,255,255,0.12);flex:0 0 auto}
.cover img{width:100%;height:100%;object-fit:cover}
.pmeta{flex:1;min-width:0}
.psong{font-weight:800;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.partist{font-size:10px;opacity:.6;margin-top:5px;letter-spacing:1.6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.progress-wrap{margin-top:12px}
.progress{width:100%;appearance:none;height:3px;border-radius:999px;background:rgba(255,255,255,0.14);outline:none}
.progress::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;border-radius:999px;background:#fff;cursor:pointer;box-shadow:0 0 0 3px rgba(255,255,255,0.08)}
.time{font-size:10px;opacity:.6;display:flex;justify-content:space-between;margin-top:7px}
.controls{margin-top:12px;display:flex;justify-content:space-between;align-items:center;gap:10px}
.volume{flex:1;appearance:none;height:3px;border-radius:999px;background:rgba(255,255,255,0.14);outline:none}
.volume::-webkit-slider-thumb{-webkit-appearance:none;width:11px;height:11px;border-radius:999px;background:#7c7cff;cursor:pointer;box-shadow:0 0 0 3px rgba(124,124,255,0.12)}
.play{width:48px;height:48px;border-radius:999px;background:#fff;color:#000;border:none;cursor:pointer;display:grid;place-items:center;box-shadow:0 14px 28px rgba(0,0,0,.45)}
.play:active{transform:scale(.98)}
</style>
</head>

<body>

<!-- ===== HOME ===== -->
<section id="home" class="page active show">
  <div class="home-wrap">
    <div class="title">MEENPRO</div>
    <div class="subtitle">BORN OF MEENPRO</div>

    <div class="center-glass" id="openMembers" role="button" aria-label="Open Members">
      <img class="center-img" src="https://img2.pic.in.th/fd621de8299f61c0a2e3602d5999ec76.png" alt="center">
      <div class="center-overlay"></div>
      <div class="center-content">
        <h2>VEGA NEVER LOSE</h2>
        <p>Standing in the Winter is Coming</p>
      </div>
    </div>
  </div>
</section>

<!-- ===== MEMBERS ===== -->
<section id="members" class="page">
  <div class="members-wrap">
    <div class="top">
      <h1>WELLESLEY</h1>
      <div class="sub">WELLESLEY MEMBERS</div>

      <div class="toolbar">
        <button class="back-btn" id="backHome">← BACK</button>
        <div class="searchbar">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M10.5 18.5a8 8 0 1 1 0-16 8 8 0 0 1 0 16Z" stroke="currentColor" stroke-width="1.7"/>
            <path d="M16.5 16.5 21 21" stroke="currentColor" stroke-width="1.7" stroke-linecap="round"/>
          </svg>
          <input id="q" type="text" placeholder="SEARCH MEMBERS..." />
        </div>
      </div>
    </div>

    <div class="section">
      <div class="section-head"><h2>FOUNDERS</h2><div class="idx">/01</div></div>
      <div class="grid" id="foundersGrid"></div>
    </div>

    <div class="section">
      <div class="section-head"><h2>LEADERS</h2><div class="idx">/02</div></div>
      <div class="grid" id="leadersGrid"></div>
    </div>

    <div class="section">
      <div class="section-head"><h2>MEMBERS</h2><div class="idx">/03</div></div>
      <div class="grid" id="membersGrid"></div>
    </div>
  </div>
</section>

<!-- ===== MUSIC PLAYER ===== -->
<div class="player" id="player">
  <div class="player-head">
    <div class="nowplaying">NOW PLAYING</div>
    <button class="toggle" id="toggleBtn" type="button">˅</button>
  </div>

  <div class="player-body">
    <div class="player-row">
      <div class="cover">
        <img src="/uploads/cover.png" alt="cover">
      </div>
      <div class="pmeta">
        <div class="psong">IS THERE SOMEONE ELSE?</div>
        <div class="partist">THE WEEKND</div>
      </div>
    </div>

    <div class="progress-wrap">
      <input type="range" id="seek" class="progress" min="0" max="100" value="0">
      <div class="time">
        <span id="current">0:00</span>
        <span id="duration">0:00</span>
      </div>
    </div>

    <div class="controls">
      <input type="range" id="volume" class="volume" min="0" max="1" step="0.01" value="0.8">
      <button class="play" id="playBtn" type="button">▶</button>
    </div>
  </div>

  <!-- ✅ วาง song.mp3 ใน public/ -->
  <audio id="audio" preload="metadata">
    <source src="/song.mp3" type="audio/mpeg">
  </audio>
</div>

<script>
/* ================= SPA showPage ================= */
const homePage = document.getElementById('home');
const membersPage = document.getElementById('members');
const openMembers = document.getElementById('openMembers');
const backHome = document.getElementById('backHome');

function showPage(target){
  [homePage, membersPage].forEach(p=>{
    p.classList.remove('show');
    p.classList.remove('active');
  });
  target.classList.add('active');
  requestAnimationFrame(()=> target.classList.add('show'));
}

/* ================= Routing: /members/ ================= */
openMembers.addEventListener('click', () => {
  history.pushState({page:"members"}, "", "/members/");
  showPage(membersPage);
  loadMembers();
});

backHome.addEventListener('click', () => {
  history.pushState({page:"home"}, "", "/");
  showPage(homePage);
});

window.addEventListener("popstate", () => {
  if (location.pathname === "/members/") {
    showPage(membersPage);
    loadMembers();
  } else {
    showPage(homePage);
  }
});

if (location.pathname === "/members/") {
  showPage(membersPage);
  loadMembers();
} else {
  showPage(homePage);
}

/* ================= Load members.json ================= */
let membersCache = null;

async function loadMembers(){
  try{
    const res = await fetch("/members.json", { cache:"no-store" });
    membersCache = await res.json();
    renderAll(membersCache);
  }catch(e){
    document.getElementById("foundersGrid").innerHTML = `<div style="opacity:.7">โหลดรายชื่อไม่สำเร็จ (members.json)</div>`;
    document.getElementById("leadersGrid").innerHTML = "";
    document.getElementById("membersGrid").innerHTML = "";
  }
}

function escapeHtml(s){
  return String(s || "").replace(/[&<>"']/g, m => ({
    "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"
  }[m]));
}

function renderGrid(id, list, tag, cls){
  const el = document.getElementById(id);
  el.innerHTML = (list || []).map(item => `
    <div class="card ${cls}" data-name="${escapeHtml(item.name)}">
      <div class="avatar">
        <img src="${item.avatar || "/uploads/avatar.png"}" alt="">
      </div>
      <div class="info">
        <div class="badge"><span class="tag">${tag}</span></div>
        <div class="name">${escapeHtml(item.name)}</div>
        <div class="meta">
          <span class="dot"></span>
          <a class="link" href="${item.facebook || "#"}" target="_blank" rel="noopener">Facebook</a>
        </div>
      </div>
    </div>
  `).join("");
}

function renderAll(data){
  renderGrid("foundersGrid", data.founders, "FOUNDER", "founder");
  renderGrid("leadersGrid", data.leaders, "LEADER", "leader");
  renderGrid("membersGrid", data.members, "MEMBER", "member");
  applySearch(); // re-filter if user typed
}

/* ================= Search ================= */
const q = document.getElementById('q');
q.addEventListener('input', applySearch);

function applySearch(){
  const term = (q.value || "").trim().toLowerCase();
  document.querySelectorAll('.card').forEach(card=>{
    const name = (card.dataset.name || "").toLowerCase();
    card.style.display = name.includes(term) ? "" : "none";
  });
}

/* ================= Player ================= */
const player = document.getElementById("player");
const toggleBtn = document.getElementById("toggleBtn");
const audio = document.getElementById("audio");
const playBtn = document.getElementById("playBtn");
const seek = document.getElementById("seek");
const volume = document.getElementById("volume");
const current = document.getElementById("current");
const duration = document.getElementById("duration");

toggleBtn.addEventListener("click", () => {
  player.classList.toggle("collapsed");
  toggleBtn.textContent = player.classList.contains("collapsed") ? "˄" : "˅";
});

function format(t){
  if(!isFinite(t) || t < 0) return "0:00";
  const m = Math.floor(t/60);
  const s = Math.floor(t%60);
  return m + ":" + (s<10 ? "0"+s : s);
}

audio.volume = Number(volume.value);
volume.addEventListener("input", () => audio.volume = Number(volume.value));

audio.addEventListener("loadedmetadata", () => {
  duration.textContent = format(audio.duration);
});

audio.addEventListener("timeupdate", () => {
  if(!isFinite(audio.duration) || audio.duration === 0) return;
  seek.value = (audio.currentTime / audio.duration) * 100;
  current.textContent = format(audio.currentTime);
});

seek.addEventListener("input", () => {
  if(!isFinite(audio.duration) || audio.duration === 0) return;
  audio.currentTime = (seek.value/100) * audio.duration;
});

playBtn.addEventListener("click", async () => {
  try{
    if(audio.paused){
      await audio.play();
      playBtn.textContent = "❚❚";
    }else{
      audio.pause();
      playBtn.textContent = "▶";
    }
  }catch(e){
    alert("Browser บล็อกการเล่นอัตโนมัติ — ให้กด Play อีกครั้ง");
  }
});

audio.addEventListener("ended", () => {
  playBtn.textContent = "▶";
  seek.value = 0;
  current.textContent = "0:00";
});
</script>

</body>
</html>
